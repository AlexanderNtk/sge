# **State Transitions**

This section outlines the state transitions within the house module's KVStore across various scenarios:

## **Deposit**

Before modifying the state, the following validations are performed:

1. If the sanity checks for making a deposit pass.
2. If authorization grants are found for both the depositor address and creator.
3. If the authorization spend limit has not been exceeded.

Upon meeting these conditions, a new deposit is created with the provided data and added to the `House` module state. Additionally, an order book participation is created in the background, and its index is assigned to the deposit.

### **Input data**

```go
newDeposit := &types.Deposit{
    Creator:                msg.Creator,
    DepositorAddress:       <ticket.DepositorAddress>,
    MarketUID:              msg.MarketUID,
    ParticipationIndex      <index of paticipation generated by code>
    Amount:                 msg.Amount,
    Fee                     <will be calculated when deposition>,
    Liquidity:              <free amount that is accessible by code and depositor>,
    WithdrawalCount:        <count of attempts of withdrawal>
    TotalWithdrawalAmount:  <total withdrawal attempts>
}
```

---

## **Withdraw**

Before modifying the state, the following validations will be performed:

1. Check if the amount is withdrawable.
2. Verify if an authorization grant exists for both the depositor address and the creator.
3. Ensure that the authorization withdraw limit has not been exceeded.

The deposit will be updated based on these criteria.


```go
    deposit.WithdrawalCount++
    deposit.TotalWithdrawalAmount = deposit.TotalWithdrawalAmount + WithdrawalAmount
```
